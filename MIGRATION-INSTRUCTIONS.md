# üöÄ TESTOGRAPH APP - DATABASE MIGRATION –ò–ù–°–¢–†–£–ö–¶–ò–ò

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –°–ª–µ–¥–≤–∞–π —Å—Ç—ä–ø–∫–∏—Ç–µ –¢–û–ß–ù–û –∫–∞–∫—Ç–æ —Å–∞ –æ–ø–∏—Å–∞–Ω–∏!

---

## üìã –©–û –ü–†–ê–í–ò –¢–ê–ó–ò –ú–ò–ì–†–ê–¶–ò–Ø:

### ‚úÖ –°–™–ó–î–ê–í–ê –ù–û–í–ò –¢–ê–ë–õ–ò–¶–ò (—Å `_app` —Å—É—Ñ–∏–∫—Å):
- `purchases` - Shopify –ø–æ–∫—É–ø–∫–∏ –∏ app –¥–æ—Å—Ç—ä–ø
- `meal_plans_app` - Meal Planner –¥–∞–Ω–Ω–∏
- `sleep_logs_app` - Sleep Protocol –¥–∞–Ω–Ω–∏
- `lab_results_app` - Lab Testing –¥–∞–Ω–Ω–∏
- `analytics_events_app` - Analytics tracking

### ‚úÖ –î–û–ë–ê–í–Ø –ö–û–õ–û–ù–ò –ö–™–ú PROFILES:
- `age`, `weight`, `goal` - –∑–∞ mini apps
- `shopify_customer_id`, `total_spent` - –∑–∞ Shopify
- `onboarding_completed`, `last_login_at` - –∑–∞ UX

### ‚úÖ –°–™–ó–î–ê–í–ê HELPER FUNCTIONS:
- `has_app_access(user_id, app_slug)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –¥–æ—Å—Ç—ä–ø
- `get_user_apps(user_id)` - —Å–ø–∏—Å—ä–∫ —Å –æ—Ç–∫–ª—é—á–µ–Ω–∏ apps

### ‚ùå –ù–ï –ü–†–û–ú–ï–ù–Ø –°–™–©–ï–°–¢–í–£–í–ê–©–ò –¢–ê–ë–õ–ò–¶–ò:
- `agents`, `chat_messages`, `chat_sessions` - –ù–ï –°–ï –ü–ò–ü–ê–¢
- `daily_entries_pro`, `weekly_measurements_pro` - –ù–ï –°–ï –ü–ò–ü–ê–¢
- `user_settings` - –ù–ï –°–ï –ü–ò–ü–ê

---

## üîß –°–¢–™–ü–ö–ê 1: –û–¢–í–û–†–ò SUPABASE DASHBOARD

1. –û—Ç–∏–¥–∏ –Ω–∞: https://supabase.com/dashboard
2. –í–ª–µ–∑ —Å —Ç–≤–æ—è account
3. –ò–∑–±–µ—Ä–∏ –ø—Ä–æ–µ–∫—Ç: **mrpsaqtmucxpawajfxfn**

---

## üìù –°–¢–™–ü–ö–ê 2: –û–¢–í–û–†–ò SQL EDITOR

1. –û—Ç –ª—è–≤–æ—Ç–æ –º–µ–Ω—é –∫–ª–∏–∫–Ω–∏ –Ω–∞: **SQL Editor**
2. –ö–ª–∏–∫–Ω–∏ –Ω–∞: **New query** (–≥–æ—Ä–µ –≤–¥—è—Å–Ω–æ)

---

## üìÑ –°–¢–™–ü–ö–ê 3: –ö–û–ü–ò–†–ê–ô SQL MIGRATION

1. –û—Ç–≤–æ—Ä–∏ —Ñ–∞–π–ª–∞:
   ```
   D:\Automation\All Testograph Ecosystem\Testograph-APP\supabase\migration-app-tables.sql
   ```

2. –ú–∞—Ä–∫–∏—Ä–∞–π **–¶–ï–õ–ò–Ø –§–ê–ô–õ** (Ctrl+A)

3. –ö–æ–ø–∏—Ä–∞–π –≥–æ (Ctrl+C)

4. –í—ä—Ä–Ω–∏ —Å–µ –≤ Supabase SQL Editor

5. –ü–æ—Å—Ç–∞–≤–∏ –≤ –ø—Ä–∞–∑–Ω–æ—Ç–æ –ø–æ–ª–µ (Ctrl+V)

---

## ‚ñ∂Ô∏è –°–¢–™–ü–ö–ê 4: –ò–ó–ü–™–õ–ù–ò MIGRATION

1. –ü—Ä–æ–≤–µ—Ä–∏ —á–µ SQL –∫–æ–¥—ä—Ç –µ –∫–æ–ø–∏—Ä–∞–Ω –ø—Ä–∞–≤–∏–ª–Ω–æ

2. –ö–ª–∏–∫–Ω–∏ –±—É—Ç–æ–Ω–∞: **Run** (–¥–æ–ª—É –≤–¥—è—Å–Ω–æ)

3. –ò–∑—á–∞–∫–∞–π –¥–∞ —Å–µ –∏–∑–ø—ä–ª–Ω–∏ (–º–æ–∂–µ –¥–∞ –æ—Ç–Ω–µ–º–µ 10-15 —Å–µ–∫—É–Ω–¥–∏)

---

## ‚úÖ –°–¢–™–ü–ö–ê 5: –ü–†–û–í–ï–†–ò –ó–ê –£–°–ü–ï–•

–°–ª–µ–¥ –∫–∞—Ç–æ migration-—ä—Ç –∑–∞–≤—ä—Ä—à–∏, —Ç—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à:

### **Success Message:**
```
Success. No rows returned
```

–ò–ª–∏:

```
Migration completed successfully
```

### **–ê–∫–æ –∏–º–∞ –≥—Ä–µ—à–∫–∞:**
- –ù–∞–ø—Ä–∞–≤–∏ screenshot –Ω–∞ –≥—Ä–µ—à–∫–∞—Ç–∞
- –ö–æ–ø–∏—Ä–∞–π —Ü—è–ª–æ—Ç–æ —Å—ä–æ–±—â–µ–Ω–∏–µ
- –ò–∑–ø—Ä–∞—Ç–∏ –≥–æ —Ç—É–∫ –≤ —á–∞—Ç–∞
- –ù–ï –ò–ó–ü–™–õ–ù–Ø–í–ê–ô migration-–∞ –≤—Ç–æ—Ä–∏ –ø—ä—Ç!

---

## üîç –°–¢–™–ü–ö–ê 6: –ü–†–û–í–ï–†–ò –¢–ê–ë–õ–ò–¶–ò–¢–ï

1. –û—Ç –ª—è–≤–æ—Ç–æ –º–µ–Ω—é –∫–ª–∏–∫–Ω–∏ –Ω–∞: **Table Editor**

2. –¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à –ù–û–í–ò–¢–ï —Ç–∞–±–ª–∏—Ü–∏:
   - `purchases`
   - `meal_plans_app`
   - `sleep_logs_app`
   - `lab_results_app`
   - `analytics_events_app`

3. –ö–ª–∏–∫–Ω–∏ –Ω–∞ `profiles` —Ç–∞–±–ª–∏—Ü–∞

4. –ö–ª–∏–∫–Ω–∏ –Ω–∞ –∏–∫–æ–Ω–∫–∞—Ç–∞ –∑–∞ –∫–æ–ª–æ–Ω–∏—Ç–µ (column icon)

5. Scroll –Ω–∞–¥–æ–ª—É - —Ç—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à –ù–û–í–ò–¢–ï –∫–æ–ª–æ–Ω–∏:
   - `age`
   - `weight`
   - `goal`
   - `shopify_customer_id`
   - `total_spent`
   - `onboarding_completed`
   - `last_login_at`

---

## üì∏ –°–¢–™–ü–ö–ê 7: –ü–û–¢–í–™–†–î–ò –£–°–ü–ï–•

–°–ª–µ–¥ –∫–∞—Ç–æ –ø—Ä–æ–≤–µ—Ä√≠—à —Ç–∞–±–ª–∏—Ü–∏—Ç–µ, –Ω–∞–ø–∏—à–∏ –≤ —á–∞—Ç–∞:

```
‚úÖ Migration –∏–∑–ø—ä–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ! –í—Å–∏—á–∫–∏ —Ç–∞–±–ª–∏—Ü–∏ —Å–∞ —Å—ä–∑–¥–∞–¥–µ–Ω–∏.
```

–ò–ª–∏ –∞–∫–æ –∏–º–∞ –ø—Ä–æ–±–ª–µ–º:

```
‚ùå –ò–º–∞ –≥—Ä–µ—à–∫–∞: [–∫–æ–ø–∏—Ä–∞–π –≥—Ä–µ—à–∫–∞—Ç–∞ —Ç—É–∫]
```

---

## üÜò –ê–ö–û –ù–ï–©–û –°–ï –û–ë–™–†–ö–ê:

### –ê–∫–æ —Å–ª—É—á–∞–π–Ω–æ –∏–∑–ø—ä–ª–Ω–∏—à migration-–∞ 2 –ø—ä—Ç–∏:
- –ù–µ —Å–µ –ø—Ä–∏—Ç–µ—Å–Ω—è–≤–∞–π! SQL-—ä—Ç –µ –Ω–∞–ø–∏—Å–∞–Ω –¥–∞ –±—ä–¥–µ **idempotent**
- –ò–∑–ø–æ–ª–∑–≤–∞ `IF NOT EXISTS` –∏ `DROP POLICY IF EXISTS`
- –ú–æ–∂–µ –¥–∞ —Å–µ –∏–∑–ø—ä–ª–Ω–∏ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º

### –ê–∫–æ –Ω—è–∫–æ–∏ —Ç–∞–±–ª–∏—Ü–∏ –≤–µ—á–µ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞—Ç:
- SQL-—ä—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —â–µ –≥–∏ –ø—Ä–æ–ø—É—Å–Ω–µ
- –©–µ —Å—ä–∑–¥–∞–¥–µ —Å–∞–º–æ –ª–∏–ø—Å–≤–∞—â–∏—Ç–µ

### –ê–∫–æ –ø–æ–ª—É—á–∏—à Permission Error:
- –£–≤–µ—Ä√≠se —á–µ —Å–∏ –≤–ª—è–∑—ä–ª —Å –ø—Ä–∞–≤–∏–ª–Ω–∏—è Supabase account
- –£–≤–µ—Ä√≠se —á–µ —Å–∏ –∏–∑–±—Ä–∞–ª –ø—Ä–∞–≤–∏–ª–Ω–∏—è –ø—Ä–æ–µ–∫—Ç

---

## üìû –ì–û–¢–û–í –õ–ò –°–ò?

–°–ª–µ–¥ –∫–∞—Ç–æ –∏–∑–ø—ä–ª–Ω–∏—à migration-–∞ —É—Å–ø–µ—à–Ω–æ, –Ω–∞–ø–∏—à–∏ –≤ —á–∞—Ç–∞ –∏ —â–µ –ø—Ä–æ–¥—ä–ª–∂–∏–º —Å—ä—Å —Å—ä–∑–¥–∞–≤–∞–Ω–µ—Ç–æ –Ω–∞ Next.js –ø—Ä–æ–µ–∫—Ç–∞! üöÄ

---

**–¢–ò –°–ò –ù–ê –†–™–ö–ê –°–ï–ì–ê - –£–°–ü–ï–•!** üí™
